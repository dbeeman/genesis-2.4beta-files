<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002 (1.62) JA patch-1.4
patched version by:  Kenshi Muto, Debian Project.
LaTeX2HTML 2002 (1.62),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>A Single compartment</TITLE>
<META NAME="description" CONTENT="A Single compartment">
<META NAME="keywords" CONTENT="tutorial2">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002 JA patch-1.4">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="tutorial2.css">

<LINK REL="next" HREF="node13.html">
<LINK REL="previous" HREF="node11.html">
<LINK REL="up" HREF="node11.html">
<LINK REL="next" HREF="node13.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html293"
  HREF="node13.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html289"
  HREF="node11.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html283"
  HREF="node11.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html291"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html294"
  HREF="node13.html">Multiple compartments</A>
<B> Up:</B> <A NAME="tex2html290"
  HREF="node11.html">Neuroscience Equations</A>
<B> Previous:</B> <A NAME="tex2html284"
  HREF="node11.html">Neuroscience Equations</A>
 &nbsp <B>  <A NAME="tex2html292"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION02121000000000000000"></A>
<A NAME="sec:single-compartment"></A>
<BR>
A Single compartment
</H2>

<P>
In the one dimensional cable equation the membrane potential is
dependent on time as well as space.  Both these axes can be
discretized independently.  We first assume that the cell is
iso-potential (same membrane potential at all places) which eliminates
the spatial dependence (if you omit the Hodgkin-Huxley conductances,
this also leads to integrate-and-fire models).

<P>
Since the cell is assumed to be iso-potential, the cable equation
reduces to a simple exponential decay function.  The question remains
how to fill in the Hodgkin-Huxley current while maintaining the
second-order accuracy of the trapezoidal rule.  The following trickery
is used for this:

<P>
<BR>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{eqnarray*}
y(t+h)
  & = 
  & y(t) + hy^{(1)}(t) + \frac{1}{2!}h^2y^{(2)}(t) +
  \frac{1}{3!}h^3y^{(3)}(t) + \cdots + \:\:\:\: \frac{1}{n!}h^ny^{(n)}(t)
  \:\:\:\: +
  \cdots \\
  y(t-h) 
  & = 
  & y(t) - hy^{(1)}(t) + \frac{1}{2!}h^2y^{(2)}(t) -
  \frac{1}{3!}h^3y^{(3)}(t) + \cdots + (-1)^n\frac{1}{n!}h^ny^{(n)}(t) +
  \cdots
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img34.png"
 ALT="$\displaystyle y(t+h)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="501" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img36.png"
 ALT="$\displaystyle y(t) + hy^{(1)}(t) + \frac{1}{2!}h^2y^{(2)}(t) +
\frac{1}{3!}h^3y^{(3)}(t) + \cdots + \:\:\:\: \frac{1}{n!}h^ny^{(n)}(t)
\:\:\:\: +
\cdots$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$\displaystyle y(t-h)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="514" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$\displaystyle y(t) - hy^{(1)}(t) + \frac{1}{2!}h^2y^{(2)}(t) -
\frac{1}{3!}h^3y^{(3)}(t) + \cdots + (-1)^n\frac{1}{n!}h^ny^{(n)}(t) +
\cdots$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
Subtract and regroup:

<P>
<BR>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{eqnarray*}
y(t+h) - y(t-h)
  & = 
  & 2hy^{(1)}(t)
  + \frac{2}{3!}h^3y^{(3)}(t) + \cdots + \:\: \frac{2}{2n!}h^{2n}y^{(2n)}(t)
  \:\: +
  \cdots \\
  & \approx
  & 2hy^{(1)}(t)
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="134" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.png"
 ALT="$\displaystyle y(t+h) - y(t-h)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="374" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img40.png"
 ALT="$\displaystyle 2hy^{(1)}(t)
+ \frac{2}{3!}h^3y^{(3)}(t) + \cdots + \:\: \frac{2}{2n!}h^{2n}y^{(2n)}(t)
\:\: +
\cdots$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img41.png"
 ALT="$\displaystyle \approx$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="65" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img42.png"
 ALT="$\displaystyle 2hy^{(1)}(t)$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
Or if you rewrite:

<P>
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:midstep-evaluation"></A><!-- MATH
 \begin{equation}
hy^{(1)}(t) \approx \frac{  y(t-h) - y(t+h) }{2}
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="212" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.png"
 ALT="$\displaystyle hy^{(1)}(t) \approx \frac{ y(t-h) - y(t+h) }{2}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.11)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
This equation has a local truncation error of third order and can be
used to fill in the membrane potential in the Hodgkin-Huxley equations
and vice versa in the following way: we assume that <IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img44.png"
 ALT="$ y(t+h)$"> is the
unknown gate value we are searching, while <IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.png"
 ALT="$ y(t-h)$"> is the previous
gate value and <!-- MATH
 $y^{(1)}(t)$
 -->
<IMG
 WIDTH="48" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img46.png"
 ALT="$ y^{(1)}(t)$"> is the rate of change for the gate value
that can be calculated given the membrane potential at time <IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.png"
 ALT="$ t$">.
Under the assumptions that <IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.png"
 ALT="$ y(t-h)$"> and the membrane potential are
second-order correct, the result of this calculation - the new values
for the gates - will be second-order correct too.  Then the same
method can be used to compute the membrane potential at time point
<IMG
 WIDTH="67" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img47.png"
 ALT="$ y(t+2h)$"> given the membrane potential at time point <IMG
 WIDTH="31" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ y(t)$"> and the
gate values at time point <IMG
 WIDTH="59" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img44.png"
 ALT="$ y(t+h)$">.

<P>
It is important to see that the second-order accuracy is maintained
only when the membrane potential and the Hodgkin-Huxley equations are
computed at different time points.

<P>
<BR>
<BR>
<BR>
<BR>

<P>
<TABLE  WIDTH="635">
<TR><TD>
  <FONT SIZE="-1"><B>NOTE:</B> If concentration pools are represented in a
    model of a neuron, they should be evaluated at the same time steps
    as the membrane potential.
</FONT></TD></TR>
</TABLE>

<P>
<BR>
<BR>
<BR>
<BR>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:midstep"></A><A NAME="245"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 1.4:</STRONG>
Mid step evaluation of membrane potential and 
    Hodgkin-Huxley equations.  To calculate the conductance at time
    point 2, we need the membrane potential at time point 1.  To
    calculate the membrane potential at time point 3, we need the
    conductance at time point 2.  The membrane potential at time point
    2 is never computed, neither the conductance at time point 3.</CAPTION>
<TR><TD><IMG
 WIDTH="379" HEIGHT="313" ALIGN="BOTTOM" BORDER="0"
 SRC="img49.png"
 ALT="\includegraphics[scale=0.6]{figures/mstep.eps}"></TD></TR>
</TABLE>
</DIV>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html293"
  HREF="node13.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html289"
  HREF="node11.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html283"
  HREF="node11.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html291"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html294"
  HREF="node13.html">Multiple compartments</A>
<B> Up:</B> <A NAME="tex2html290"
  HREF="node11.html">Neuroscience Equations</A>
<B> Previous:</B> <A NAME="tex2html284"
  HREF="node11.html">Neuroscience Equations</A>
 &nbsp <B>  <A NAME="tex2html292"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>

2002-11-15
</ADDRESS>
</BODY>
</HTML>
